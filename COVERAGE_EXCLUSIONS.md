# Test Coverage Exclusions

## Overview
JaCoCo is configured to exclude certain classes from code coverage reports to focus on business logic and meaningful code coverage metrics.

## Excluded Packages/Classes

### 1. Repository Interfaces
**Package**: `**/repository/jpa/**`
- Spring Data JPA repository interfaces
- Auto-generated by Spring Data
- No business logic to test

**Examples**:
- `GameRepository`
- `CampaignRepository`
- `BrandRepository`
- `UserRepository`
- `PlayEventRepository`

### 2. Entity Classes
**Package**: `**/repository/entity/**`
- JPA entity classes
- Simple POJOs with getters/setters
- Minimal logic (mostly data holders)

**Examples**:
- `GameEntity`
- `CampaignEntity`
- `BrandEntity`
- `UserEntity`
- `PlayEventEntity`

### 3. DTOs (Data Transfer Objects)
**Package**: `**/dto/**`
- Simple data transfer objects
- No business logic
- Just data containers

**Examples**:
- `PlayEventDto`
- `PlayResultDto`
- `GameDto`
- `CampaignDto`

### 4. Enums
**Package**: `**/enums/**`
- Enumeration types
- No complex logic
- Type-safe constants

**Examples**:
- `GameStatus`
- `CampaignStatus`
- `PlayStatus`
- `ProbabilityType`

### 5. Constants
**Package**: `**/constant/**`
- Static constant classes
- No logic to test

**Examples**:
- `RedisKeys`
- `KafkaTopics`

### 6. Configuration Classes
**Package**: `**/config/**`
- Spring configuration classes
- Bean definitions
- Infrastructure setup

**Examples**:
- `RedisConfig`
- `KafkaConfig`
- `WebSocketConfig`

### 7. Main Application Class
**Class**: `FrolicApplication.class`
- Spring Boot main entry point
- Just `SpringApplication.run()`

## Rationale

These classes are excluded because:
1. **No Business Logic**: They contain minimal or no business logic
2. **Framework Generated**: Many are auto-generated or framework-managed
3. **Simple POJOs**: Just data holders with getters/setters
4. **Infrastructure Code**: Configuration and setup code
5. **Testing Overhead**: Testing them provides little value vs. effort

## What IS Covered

The coverage report focuses on:
- ✅ Service layer (business logic)
- ✅ Engine components (probability calculator, concurrency handlers)
- ✅ Cache stores (Redis operations)
- ✅ Utility classes (time, JSON, ID generation)
- ✅ Controllers (API endpoints)
- ✅ Messaging producers/consumers
- ✅ Exception handlers

## Running Coverage Reports

### Generate Report
```bash
mvn clean test jacoco:report
```

### View Report
Open: `target/site/jacoco/index.html` in each module:
- `frolic-core/target/site/jacoco/index.html`
- `frolic-services/target/site/jacoco/index.html`

### Aggregate Report (Both Modules)
```bash
mvn clean test
mvn jacoco:report-aggregate
```

## Coverage Goals

With exclusions, target coverage:
- **Line Coverage**: 80%+
- **Branch Coverage**: 75%+
- **Method Coverage**: 85%+

## Modifying Exclusions

To modify exclusions, edit the `pom.xml` in the parent project:

```xml
<plugin>
    <groupId>org.jacoco</groupId>
    <artifactId>jacoco-maven-plugin</artifactId>
    <configuration>
        <excludes>
            <!-- Add or remove patterns here -->
            <exclude>**/your/package/**</exclude>
        </excludes>
    </configuration>
</plugin>
```

## Integration with CI/CD

In GitHub Actions or Jenkins:
```yaml
- name: Generate coverage report
  run: mvn clean test jacoco:report

- name: Upload coverage to Codecov
  uses: codecov/codecov-action@v2
  with:
    files: ./frolic-core/target/site/jacoco/jacoco.xml,./frolic-services/target/site/jacoco/jacoco.xml
```

## Best Practices

1. **Focus on Logic**: Test code that contains business logic
2. **Meaningful Metrics**: Exclude boilerplate to get meaningful coverage numbers
3. **Regular Review**: Periodically review exclusions to ensure they're still relevant
4. **Document Reasons**: Always document why classes are excluded

## Notes

- Integration tests for repositories exist but don't count toward coverage
- Entity classes are tested indirectly through service/repository tests
- Configuration classes are tested through integration tests
- DTOs are validated through API/service layer tests
